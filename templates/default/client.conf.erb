# OpenVPN client config file
#
# Generated by Chef

client

remote <%= @config[:remote_host] %> <%= @config[:remote_port] ? @config[:remote_port] : @config[:port] %>
proto <%= @config[:proto] %>
dev <%= @config[:dev] %>
;dev-node OpenVPN-TAP

<% if @config[:auth][:type] == "cert_passwd" || @config[:auth][:type] == "passwd" -%>
auth-user-pass
;auth-nocache
<% end -%>

<% if @config[:auth][:type].to_s.start_with? "cert" -%>
cert <%= @config_name %>-<%= @user_name %>.crt
key  <%= @config_name %>-<%= @user_name %>.key
<% end -%>
ca <%= @config_name %>-<%= @user_name %>-ca.crt

ns-cert-type server

resolv-retry infinite
nobind

<%= "comp-lzo\n" if @config[:comp_lzo] -%>
<%= "tls-cipher #{@config[:tls_cipher_algos]}\n" if @config[:tls_cipher_algos] -%>
<%= "cipher #{@config[:cipher_algo]}\n" if @config[:cipher_algo] -%>
<%= "keysize #{@config[:keysize]}\n" if @config[:keysize] -%>
<%= "auth #{@config[:auth_algo]}\n" if @config[:auth_algo] -%>

user openvpn
group openvpn

persist-key
persist-tun

log-append /var/log/openvpn/<%= @config_name %>.log
;mute-replay-warnings
verb 3
mute 20
